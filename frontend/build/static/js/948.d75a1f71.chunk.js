"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[948,1181],{70126:(e,t,a)=>{a.d(t,{A:()=>y});var n=a(90221),s=a(26441),l=(a(65043),a(79456)),r=a(2364),o=a(57290),i=a(70579);const c=e=>(0,i.jsx)(o.c.DropdownIndicator,{...e,children:(0,i.jsx)(n.QDT,{size:"0.625rem"})}),u={control:e=>({...e,borderTopRightRadius:".125rem",borderBottomRightRadius:".125rem",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",fontSize:"0.75rem",fontWeight:"400",padding:"0.375rem 0.3125rem",color:"#071F45",outline:"none",border:"none",boxShadow:"none",cursor:"pointer",height:"100%",backgroundColor:"#F79009",minHeight:"100%","&:hover":{backgroundColor:"#DC6803"}}),container:e=>({...e,height:"100%",position:"absolute",right:0,width:"3rem",top:0,bottom:0}),option:(e,t)=>{let{isFocused:a,isSelected:n}=t;return{...e,fontSize:".75rem",fontWeight:"400",color:n||a?"#ffffff":"#071F45",backgroundColor:n?"#0090A3":a?"#00B4CC":"#ffffff",transition:"all 0.2s ease",overflow:"hidden",cursor:"pointer",textAlign:"center"}},menu:e=>({...e,overflow:"hidden"}),singleValue:e=>({...e,fontSize:".75rem",fontWeight:"400",color:"#ffffff",margin:0,textAlign:"center"}),valueContainer:e=>({...e,padding:0}),indicatorsContainer:e=>({...e}),dropdownIndicator:e=>({...e,padding:0,color:"#ffffff"})};var d=a(72096);const m=function(e){let{value:t,onChange:a,option:n,onSelect:s}=e;const{currencyType:o}=(0,l.d4)((e=>e.currency)),m=[{value:o,label:o},{value:"%",label:"%"}];return(0,i.jsxs)("div",{className:"flex w-[11.75rem] border border-warning-500 rounded-[0.25rem] outline outline-transparent outline-0 focus-within:outline-2 focus-within:outline-warning-500 transition-all ease-in-out duration-100 relative",children:[(0,i.jsx)("input",{className:"w-[8.6875rem] placeholder-blue-200 py-[0.3125rem] px-[.3125rem] rounded-l-[0.25rem] outline-0 text-sm text-right transition-all ease-in-out duration-100",placeholder:"".concat((0,d.t)("misol"),": 100 000 000"),type:"number",value:t,onChange:e=>{a(e.target.value)},onWheel:e=>e.target.blur(),min:0}),(0,i.jsx)(r.Ay,{onChange:s,styles:u,isSearchable:!1,value:n,options:m,components:{IndicatorSeparator:()=>null,DropdownIndicator:c}})]})},h=e=>{let{value:t,onChange:a,option:n,onSelect:s}=e;return(0,i.jsxs)("div",{className:"flex justify-between w-full items-center mb-[1rem]",children:[(0,i.jsxs)("div",{className:"text-black-700 text-[0.875rem]",children:[(0,d.t)("Chegirma")," :"]}),(0,i.jsx)(m,{onChange:a,onSelect:s,value:t,option:n})]})};var b=a(66899);const p=e=>{let{onClick:t}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("button",{onClick:t,className:"exitbtn",children:(0,i.jsx)(n.FyX,{size:"0.75rem"})})})};const x=function(e){let{mix:t,value:a,onChange:n,label:s,onClose:l,keyInput:r,placeholder:o,type:c,disabled:u}=e;return(0,i.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,i.jsxs)("span",{className:"custom-payment-text-style",children:[s," :"]}),(0,i.jsxs)("div",{className:"flex items-center w-[11.75rem] gap-[0.625rem]",children:[(0,i.jsx)(b.A,{placeholder:o||"".concat((0,d.t)("misol"),": 100 000 000"),type:c||"number",value:a,disabled:u,onChange:e=>{n(e.target.value,r)}}),t&&(0,i.jsx)(p,{onClick:()=>l(r)})]})]})};var f=a(73216),g=a(9762);const y=function(e){let{returned:t,active:a,togglePaymentModal:r,hasCalendar:o,hiddenDebt:c,type:u="cash",showPayEndDate:m,cash:b="",card:p="",transfer:y="",hiddenMixed:v,discount:N,hasDiscount:C,hasDiscountBtn:j,debt:S,allPayment:k,paid:w=0,client:z="",onChange:P,onClose:D,changePaymentType:T,discountSelectOption:I,handleClickDiscountBtn:A,handleChangeDiscountSelectOption:O,handleChangeDiscount:Q,handleClickPay:M,clickdelay:q,disableInputsCashCard:B,payEndDate:R,handlePayEndDateChange:E,disablePayButton:F}=e;const L=(0,f.zy)(),W=()=>{switch(u){case"card":return(0,i.jsx)(x,{value:p,keyInput:u,onChange:P,onClose:D,disabled:B,label:(0,d.t)("Plastik")},"sale-card1");case"transfer":return(0,i.jsx)(x,{value:y,keyInput:u,onChange:P,onClose:D,disabled:B,label:(0,d.t)("O`tkazma")},"sale-transfer");case"mixed":return[{label:(0,d.t)("Naqd"),key:"cash",value:b},{label:(0,d.t)("Plastik"),key:"card",value:p},{label:(0,d.t)("O`tkazma"),key:"transfer",value:y}].map((e=>(0,i.jsx)(x,{value:e.value,keyInput:e.key,onChange:P,onClose:D,label:(0,d.t)(e.label)},"sale-".concat(e.key))));default:return(0,i.jsx)(x,{disabled:B,value:b,onChange:P,keyInput:u,onClose:D,label:(0,d.t)("Naqd")},"sale-cash")}},{currencyType:G}=(0,l.d4)((e=>e.currency));return(0,i.jsxs)("section",{className:"fixed transition-all left-0 top-0 right-0 bottom-0 overflow-hidden duration-200 ease-out bg-black-300 backdrop-blur-[3px] z-20 ".concat(a?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),onClick:r,children:[(0,i.jsx)("h3",{className:"text-white-900 text-lg leading-[1.875rem absolute top-[50%] left-[35%] -translate-x-[50%]",children:(0,d.t)("")}),(0,i.jsxs)("div",{className:"customerPay-head-style transition-all duration-200 ease-linear h-full overflow-auto absolute top-0 bottom-0 right-0 ".concat(a?"translate-x-0":"translate-x-full"),onClick:e=>e.stopPropagation(),autoFocus:!0,children:[(0,i.jsxs)("div",{className:"top-payment w-full",children:[z&&(0,i.jsxs)("div",{className:"customer-head-icon",children:[(0,i.jsxs)("div",{className:"flex items-center custom-payment-text-style",children:[(0,i.jsx)(n.uSr,{className:"mr-[0.75rem]"}),(0,i.jsxs)("span",{children:[(0,d.t)("Mijoz")," : "]})]}),(0,i.jsx)("h3",{className:"text-[0.875rem]",children:z})]}),(0,i.jsxs)("div",{className:"mb-[1.25rem] font-medium text-[1.25rem] text-center leading-[23.44px]",children:[null===k||void 0===k?void 0:k.toLocaleString("ru-Ru")," ",G]}),(0,i.jsxs)("ul",{className:"w-full pb-[1.25rem]",children:[!t&&W(),(L.pathname.includes("/kassa/debts")||L.pathname.includes("/qarzdorlar")||L.pathname.includes("/maxsulotlar/qabul/qabulqilish")||L.pathname.includes("/maxsulotlar/qabul/qabullar"))&&W(),C&&(0,i.jsx)(h,{value:N,onChange:Q,option:I,onSelect:O}),m&&(0,i.jsxs)("li",{className:"custom-payment-ul-li justify-between flex gap-x-5",children:[(0,i.jsxs)("span",{className:"custom-payment-text-style",children:[(0,d.t)("To'lov sanasi"),":"]}),(0,i.jsx)(g.A,{onChange:E,value:R,placeholder:"To'lov sanasi",disableIcon:!0})]}),c?null:(0,i.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,i.jsxs)("span",{className:"custom-payment-text-style",children:[(0,d.t)("Qarzlar")," :"," "]}),(0,i.jsxs)("h3",{className:"text-error-500 text-[1rem]",children:[S.toLocaleString("ru-Ru")," ",G]})]}),(0,i.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,i.jsxs)("span",{className:"custom-payment-text-style",children:[k<0?(0,d.t)("Qaytarilayotgan"):(0,d.t)("To`lanayotgan")," ",":"," "]}),(0,i.jsxs)("h3",{className:"text-[1rem] text-loginButton",children:[null===w||void 0===w?void 0:w.toLocaleString("ru-Ru")," ",G]})]})]})]}),(0,i.jsxs)("div",{className:"bottom-payment w-full flex flex-col gap-[1.25rem] border-t-[1px] border-black-200 pt-[1.25rem]",children:[(0,i.jsxs)("div",{className:"custom-paymet-btn",children:[(0,i.jsx)(s.Gv,{text:(0,d.t)("Naqd"),type:"cash",active:"cash"===u,onClick:T}),(0,i.jsx)(s.Gv,{text:(0,d.t)("Plastik"),type:"card",active:"card"===u,onClick:T}),(0,i.jsx)(s.Gv,{text:(0,d.t)("O'tkazma"),type:"transfer",active:"transfer"===u,onClick:T}),!t&&(0,i.jsx)(s.Gv,{text:(0,d.t)("Aralash"),type:"mixed",active:"mixed"===u,onClick:T}),L.pathname.includes("/kassa/debts")&&(0,i.jsx)(s.Gv,{text:(0,d.t)("Aralash"),type:"mixed",active:"mixed"===u,onClick:T})]}),!t&&j&&(0,i.jsx)(s.eV,{text:(0,d.t)("Chegirma"),onClick:A}),(0,i.jsx)(s.p2,{text:(0,d.t)("To'lash"),disablePayButton:q,loading:q,onClick:q?()=>console.log("wait"):M})]})]})]})}},270:(e,t,a)=>{a.r(t),a.d(t,{convertToUsd:()=>x,convertToUzs:()=>f,default:()=>g});var n=a(65043),s=a(79456),l=a(12602),r=a(18446),o=a(3297),i=a(30200),c=a(72096),u=a(4235),d=a(11108),m=a(73216),h=a(70126),b=a(73734),p=a(70579);const x=e=>Math.round(1e3*e)/1e3,f=e=>Math.round(e),g=()=>{const[e,t]=(0,n.useState)(window.innerWidth<=768);(0,n.useEffect)((()=>{const e=()=>{t(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const a=(0,s.wA)(),g=(0,m.zy)(),{market:y,user:v}=(0,s.d4)((e=>e.login)),{clients_info:N}=(0,s.d4)((e=>e.clients)),{sellings:C}=(0,s.d4)((e=>e.sellings)),{currencyType:j,currency:S}=(0,s.d4)((e=>e.currency)),[k,w]=(0,n.useState)(0),[z,P]=(0,n.useState)(10),[D,T]=(0,n.useState)({id:"",client:""}),[I,A]=(0,n.useState)(N),[O,Q]=(0,n.useState)(!1),[M,q]=(0,n.useState)({filter:"",sort:"",count:0}),[B,R]=(0,n.useState)(N),[E,F]=(0,n.useState)(""),[L,W]=(0,n.useState)(null),[G,U]=(0,n.useState)({usd:0,uzs:0}),[Y,_]=(0,n.useState)(!1),[V,H]=(0,n.useState)({}),[J,X]=(0,n.useState)(!1),[K,Z]=(0,n.useState)("cash"),[$,ee]=(0,n.useState)(""),[te,ae]=(0,n.useState)(""),[ne,se]=(0,n.useState)(""),[le,re]=(0,n.useState)(""),[oe,ie]=(0,n.useState)(""),[ce,ue]=(0,n.useState)(""),[de,me]=(0,n.useState)(0),[he,be]=(0,n.useState)(0),[pe,xe]=(0,n.useState)(0),[fe,ge]=(0,n.useState)(0),[ye,ve]=(0,n.useState)(0),[Ne,Ce]=(0,n.useState)(0),[je,Se]=(0,n.useState)(""),[ke,we]=(0,n.useState)(S),[ze,Pe]=(0,n.useState)(""),[De,Te]=(0,n.useState)([]),[Ie,Ae]=(0,n.useState)("");let Oe=null;const Qe=[{title:"\u2116"},{title:(0,c.t)("Sana"),filter:"createdAt"},{title:(0,c.t)("Mijoz")},{title:(0,c.t)("Jami")},{title:(0,c.t)("Chegirma")},{title:(0,c.t)("Qarz")},{title:(0,c.t)("Qayratilganlar")},{title:(0,c.t)("Qarzdan to'lov")},{title:"",styles:"w-[7rem]"}],Me=()=>{Q(!1),setTimeout((()=>{F("")}),500)},qe=(e,t)=>{if("firstPay"===t)F("checkSell"),W(e),Q(!O);else if("oneAllPay"===t)F("oneSaleDebtPayments"),W(e),Q(!O);else{F("allSaleDebtPayments");let t=[];e.map((e=>{t.push(...e.saleconnector.payments)})),W({payments:t.filter((e=>void 0===e.totalpriceuzs))}),Q(!O)}},Be=e=>{if(e===M.filter)switch(M.count){case 1:q({filter:e,sort:"1",count:2}),(0,i.Yc)(I,A,e,1,B);break;case 2:q({filter:e,sort:"",count:0}),(0,i.Yc)(I,A,e,"",B);break;default:q({filter:e,sort:"-1",count:1}),(0,i.Yc)(I,A,e,-1,B)}else q({filter:e,sort:"-1",count:1}),(0,i.Yc)(I,A,e,-1,B)},Re=()=>{const e=g.state;let t={market:y,clientId:e};a((0,d.LY)(t))};(0,n.useEffect)((()=>{Re()}),[a,y]),(0,n.useEffect)((()=>{A(N)}),[N]);const Ee=()=>{X(!1)},Fe=(e,t)=>{const a=Math.abs(pe),n=Math.abs(fe);if("USD"===j)if("cash"===t){const t=Number(e)+Number(ne)+Number(oe),s=Number((0,i.IQ)(e,ke))+Number(le)+Number(ce);t<=a?(ee(e),ae((0,i.IQ)(e,ke)),me(x(a-t)),be(f(n-s)),ve(t),Ce(s)):(0,b.OC)()}else if("card"===t){const t=Number(e)+Number($)+Number(oe),s=Number(te)+Number((0,i.IQ)(e,ke))+Number(ce);t<=a?(se(e),re((0,i.IQ)(e,ke)),me(x(a-t)),be(f(n-s)),ve(t),Ce(s)):(0,b.OC)()}else{const t=Number(e)+Number($)+Number(ne),s=Number(te)+Number(le)+Number((0,i.IQ)(e,ke));t<=a?(ie(e),ue((0,i.IQ)(e,ke)),me(x(a-t)),be(f(n-s)),ve(t),Ce(s)):(0,b.OC)()}else if("cash"===t){const t=Number(e)+Number(le)+Number(ce),s=Number((0,i.Ch)(e,ke))+Number(ne)+Number(oe);t<=n?(ae(e),ee((0,i.Ch)(e,ke)),me(x(a-s)),be(f(n-t)),ve(s),Ce(t)):(0,b.OC)()}else if("card"===t){const t=Number(e)+Number(te)+Number(ce),s=Number($)+Number((0,i.Ch)(e,ke))+Number(oe);t<=n?(se((0,i.Ch)(e,ke)),re(e),me(x(a-s)),be(f(n-t)),ve((0,i.Ch)(t,ke)),Ce(t)):(0,b.OC)()}else{const t=Number(e)+Number(te)+Number(le),s=Number($)+Number(ne)+Number((0,i.Ch)(e,ke));t<=n?(ie((0,i.Ch)(e,ke)),ue(e),me(x(a-s)),be(f(n-t)),ve(s),Ce(t)):(0,b.OC)()}},[Le,We]=(0,n.useState)(!1);return(0,p.jsxs)("div",{className:"relative overflow-auto ",children:[Y&&(0,p.jsx)("div",{className:"fixed backdrop-blur-[2px] z-[100] left-0 top-0 right-0 bottom-0 bg-white-700 flex flex-col items-center justify-center w-full h-full",children:(0,p.jsx)(u.A,{})}),(0,p.jsx)("div",{className:"lg:ps-[20px] lg:tableContainerPadding ",children:I.length>0&&(e?(0,p.jsx)(o.A,{page:"clientssales",headers:Qe,data:I,currentPage:k,countPage:z,currency:j,reports:!0,Print:qe,Sort:Be,sortItem:M}):(0,p.jsx)(r.A,{page:"clientssales",headers:Qe,data:I,currentPage:k,countPage:z,currency:j,reports:!0,Print:qe,Sort:Be,sortItem:M,Pay:e=>{X(!0);const{debt:t,saleconnector:a,products:n}=e;Te(n),Ae(a._id);const s=t.debt,l=t.debtuzs;Se(t._id),xe(s),ge(l),ee(s),ae(l),ve(s),Ce(l),X(!0),X(!0)},totalDebt:G}))}),(0,p.jsx)(h.A,{returned:!1,type:K,active:J,togglePaymentModal:Ee,changePaymentType:e=>{if(K!==e)switch(Z(e),e){case"cash":ee(pe),ae(fe),se(""),re(""),ie(""),ue(""),ve(pe),Ce(fe),me(0),be(0);break;case"card":se(pe),re(fe),ee(""),ae(""),ie(""),ue(""),ve(pe),Ce(fe),me(0),be(0);break;case"transfer":ie(pe),ue(fe),ee(""),ae(""),se(""),re(""),ve(pe),Ce(fe),me(0),be(0);break;default:ee(""),ae(""),se(""),re(""),ie(""),ue(""),ve(0),Ce(0),me(pe),be(fe)}},onChange:(e,t)=>{Fe(e,t)},client:null,allPayment:fe,card:le,cash:te,hiddenMixed:!0,debt:he,discount:null,handleChangeDiscount:e=>{console.log("Discount changed:",e)},hasDiscount:!1,changeComment:()=>Pe(""),transfer:ce,handleClickDiscountBtn:()=>{console.log("Discount button clicked")},discountSelectOption:{value:"USD",label:"USD"},handleChangeDiscountSelectOption:e=>{console.log("Discount select option changed to:",e)},paid:Ne,disablePayButton:Le,handleClickPay:()=>{null===Oe&&(Oe=window.setTimeout((()=>{Oe=null,F("complete"),Q(!0)}),300))},clickdelay:Le}),(0,p.jsx)(l.A,{body:E,toggleModal:"sell"===E?()=>{F(""),Q(!O),setTimeout((()=>{}),500)}:"complete"===E?Me:"allChecks"===E?()=>{Q(!O),F(""),F(null)}:()=>{Q(!O),F(""),W(null)},isOpen:O,payment:L,printedSelling:"dailySaleCheck"===E?V:L,product:L,headers:Qe,headerText:"complete"===E&&"To'lovni amalga oshirishni tasdiqlaysizmi?",title:"complete"===E&&"To'lovni amalga oshirgach bu ma`lumotlarni o'zgaritirib bo'lmaydi!",approveFunction:()=>{Me();const e={payment:{totalprice:Number(pe),totalpriceuzs:Number(fe),type:K,cash:Number($),cashuzs:Number(te),card:Number(ne),carduzs:Number(le),transfer:Number(oe),transferuzs:Number(ce),discount:0,discountuzs:0},user:v._id,saleconnectorid:Ie,products:De,debt_id:je};a((0,d.nO)(e)).then((e=>{let{payload:t}=e;We(!0),W(t),setTimeout((()=>{F("checkPayment"),Q(!0),Re(),We(!1),Ee()}),500)}))}})]})}}}]);
//# sourceMappingURL=948.d75a1f71.chunk.js.map