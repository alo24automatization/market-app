"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[156,1181],{98668:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(72096),i=r(90221),o=r(70579);const l=function(e){let{id:t,title:r,code:l,products:d,activeCategory:c,onClick:s}=e;return(0,o.jsxs)("div",{className:"category-card ".concat(c?"active-category":""),onClick:()=>s(t),children:[(0,o.jsx)("h1",{className:"text-black-700 text-base leading-[1.5625rem]",children:r||(0,a.t)("Nomsiz kategoriya")}),(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,o.jsxs)("p",{className:"footer-text",children:[(0,a.t)("Kodi")," :"]}),(0,o.jsx)("span",{className:"block rounded-[3.125rem] bg-warning-500 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:l||0})]}),(0,o.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,o.jsxs)("p",{className:"footer-text",children:[(0,a.t)("Maxsulot turlari")," :"]}),(0,o.jsx)("span",{className:"block rounded-[3.125rem] bg-success-400 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:d||0})]})]}),(0,o.jsx)("div",{className:"category-card-checkmark",children:(0,o.jsx)(i.KDk,{size:"1rem",className:"check-icon"})})]})}},22662:(e,t,r)=>{r.d(t,{A:()=>o});const a=(0,r(55749).Ay)("http://185.241.61.68/"),i=JSON.parse(localStorage.getItem("userData"));a.auth={token:null===i||void 0===i?void 0:i.token,market:null===i||void 0===i?void 0:i.market};const o=a},31206:(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});var a=r(65043),i=r(47630),o=r(18446),l=r(79456),d=r(80827),c=r(4235),s=r(53536),n=r(98668),u=r(78054),p=r(90221),m=r(49092),v=r(91466),g=r(22662),x=r(73734),h=r(75515),b=r(30200),f=r(12602),y=r(73216),j=r(95345),N=r(70579);const _=function(){const{t:e}=(0,m.B)(["common"]),t=(0,l.wA)(),r=(0,y.zy)(),_=(0,y.Zp)(),{currencyType:k,currency:w}=(0,l.d4)((e=>e.currency)),{connections:z,loading:S}=(0,l.d4)((e=>e.connections)),{market:C}=(0,l.d4)((e=>e.login)),{categoriesPartner:P,allProductsPartner:A}=(0,l.d4)((e=>e.registerOrders)),[M,E]=(0,a.useState)(),[D,q]=(0,a.useState)(null),[Y,B]=(0,a.useState)(P),[K,O]=(0,a.useState)([]),[I,Q]=(0,a.useState)(null),[T,J]=(0,a.useState)(""),[F,G]=(0,a.useState)([]),[U,X]=(0,a.useState)(""),[L,R]=(0,a.useState)(!1),[W,Z]=(0,a.useState)(null),[$,H]=(0,a.useState)(null),[V,ee]=(0,a.useState)(null),[te,re]=(0,a.useState)("recived"),[ae,ie]=(0,a.useState)("orderProducts"),oe=e=>{I===e?Q(null):(Q(e),J(""),B(P))},le=()=>{G([]),q(null)};return(0,a.useEffect)((()=>{let e=[],r=[];C&&D&&(g.A.emit("getPartnerProducts",{market:C._id,partner:D.value}),g.A.on("partnerCategories",(e=>{let{id:r,categories:a}=e;r===C._id&&(t((0,h.B1)(a)),B(a))})),g.A.on("setPartnerProducts",(a=>{let{id:i,products:o}=a;i===C._id&&(r=[...r,...(0,s.map)(o,(e=>({value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)})))],O(r),e.push(...o),t((0,h.Ql)(e)))})),g.A.on("error",(e=>{let{id:t,message:r}=e;t===C._id&&(0,x.lY)(r,"error")})))}),[C,t,D]),(0,a.useEffect)((()=>{t((0,v.cX)())}),[t]),(0,a.useEffect)((()=>{if(I){const e=(0,s.filter)(A,(e=>e.category._id===I));O((0,s.map)(e,(e=>({value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)}))))}else O((0,s.map)(A,(e=>({value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)}))))}),[I,A]),(0,a.useEffect)((()=>{const e=(0,s.map)(z,(e=>({label:(null===e||void 0===e?void 0:e.name)+" - "+(null===e||void 0===e?void 0:e.inn),value:e._id})));E(e)}),[z]),(0,a.useEffect)((()=>{const e=r.state;var t;e&&e.temporary&&(Z(e),G(null===e||void 0===e?void 0:e.temporary.tableProducts),q(null===e||void 0===e||null===(t=e.temporary)||void 0===t?void 0:t.partner));if(e&&e.order){"requested"===e.position&&(re("recived"),ie("orderProducts")),"delivered"===e.position&&(re("delivered"),ie("receiveOrderProducts")),ee(e.order),q({label:e.order.sender.name+" - "+e.order.sender.inn,value:e.order.sender._id});const t=(0,s.map)(e.order.products,(e=>{var t,r,a,i,o,l,d,c,s,n,u;return{_id:e._id,sender:e.sender,product:{_id:null===(t=e.product)||void 0===t?void 0:t._id,code:null===(r=e.product)||void 0===r||null===(a=r.productdata)||void 0===a?void 0:a.code,name:null===(i=e.product)||void 0===i||null===(o=i.productdata)||void 0===o?void 0:o.name,barcode:null===(l=e.product)||void 0===l||null===(d=l.productdata)||void 0===d?void 0:d.barcode},productdata:null===(c=e.product)||void 0===c?void 0:c.productdata._id,category:null===e||void 0===e||null===(s=e.product)||void 0===s?void 0:s.category._id,totalprice:null===e||void 0===e?void 0:e.totalprice,totalpriceuzs:e.totalpriceuzs,pieces:{...null===e||void 0===e?void 0:e.pieces},total:null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.total,unitprice:null===e||void 0===e?void 0:e.unitprice,unitpriceuzs:null===e||void 0===e?void 0:e.unitpriceuzs,unit:null===e||void 0===e||null===(u=e.product)||void 0===u?void 0:u.unit}}));G(t)}window.history.replaceState({},document.title)}),[r.state]),(0,N.jsxs)("section",{className:"flex grow relative overflow-auto",children:[(0,N.jsx)(f.A,{body:U,isOpen:L,headerText:"complete"===U?"Buyurtma uchun so'rov yuborishni tasdiqlaysizmi?":"",toggleModal:()=>{R(!1),setTimeout((()=>{X("")}),500)},approveFunction:()=>{if(F.length>0){const e={partner:D.value,products:F,orderId:V?V._id:null};t("delivered"===te?(0,h.XR)(e):V?(0,h.iY)(e):(0,h.fS)(e)).then((e=>{let{error:r,payload:a}=e;r||(V&&ee(null),H(a),setTimeout((()=>{X("checkOrder"),R(!0),le()}),500),W&&(t((0,j.rG)({temporaryId:W._id})),Z(null)))}))}else(0,x.lY)(e("Maxsulotlar ro'yxati bo'sh!"),"warning")},order:$}),(0,N.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem] overflow-auto",children:[(0,N.jsxs)("div",{className:"mainPadding flex flex gap-[1.25rem]",children:[(0,N.jsx)(i.A,{select:!0,placeholder:"",value:D||"",label:e("Do`kon nomi"),onChange:e=>q(e),options:M,border:!0,disabled:"delivered"===te}),(0,N.jsx)(i.A,{disabled:!D||"delivered"===te,select:!0,placeholder:e("misol: kompyuter"),value:"",label:e("Maxsulotlar"),onChange:t=>{if(t.barcode?(0,s.filter)(F,(e=>e.product.barcode===t.barcode)).length>0:(0,s.filter)(F,(e=>e.product._id===t.value)).length>0)(0,x.lY)(e("Maxsulot ro'yxatda mavjud !"),"error");else{const e=t.barcode?A.find((e=>e.productdata.barcode===t.barcode)):A.find((e=>e._id===t.value)),r={sender:D.value,product:{_id:e._id,code:e.productdata.code,name:e.productdata.name,barcode:e.productdata.barcode},productdata:e.productdata._id,category:e.category._id,totalprice:e.price.sellingprice,totalpriceuzs:e.price.sellingpriceuzs,pieces:{recived:1},total:e.total,unitprice:e.price.sellingprice,unitpriceuzs:e.price.sellingpriceuzs,unit:e.unit};G([...F,r])}},options:K})]}),(0,N.jsx)("div",{className:"tableContainerPadding",children:F.length?(0,N.jsx)(o.A,{page:ae,data:F,headers:{recived:[{title:"\u2116"},{title:"Maxsulot kodi"},{title:"Maxsulot nomi"},{title:"Maxsulot soni"},{title:"Maxsulot narxi"},{title:"Soni"},{title:"Jami"},{title:""}],delivered:[{title:"\u2116"},{title:"Maxsulot kodi"},{title:"Maxsulot nomi"},{title:"So'ralgan"},{title:"Yuborilgan"},{title:"Qabul qilinayotgan"},{title:"Narxi"},{title:"Jami"}]}[te],currency:k,increment:e=>{const t=(0,s.map)(F,(t=>t.product._id===e?{...t,pieces:{...t.pieces,[te]:Number(t.pieces[te])+1},totalprice:(0,b.tE)((Number(t.pieces[te])+1)*t.unitprice),totalpriceuzs:(0,b.Df)((Number(t.pieces[te])+1)*t.unitpriceuzs)}:t));G(t)},decrement:e=>{const t=(0,s.map)(F,(t=>t.product._id===e?{...t,pieces:{...t.pieces,[te]:Number(t.pieces[te])>0?Number(t.pieces[te])-1:0},totalprice:(0,b.tE)((Number(t.pieces[te])>0?Number(t.pieces[te])-1:0)*t.unitprice),totalpriceuzs:(0,b.Df)((Number(t.pieces[te])>0?Number(t.pieces[te])-1:0)*t.unitpriceuzs)}:t));G(t)},handleDelete:e=>{F.splice(e,1),G([...F])},footer:"registersale",handleCountProduct:(e,t)=>{const r=Number(e.target.value),a=(0,s.map)(F,(e=>e.product._id===t?{...e,pieces:{...e.pieces,[te]:r},totalprice:(0,b.tE)(r*e.unitprice),totalpriceuzs:(0,b.Df)(r*e.unitpriceuzs)}:e));G(a)}}):(0,N.jsx)(u.A,{text:e("Buyurtmaga mahsulotlar qo'shilmagan!...")})})]}),(0,N.jsxs)("div",{className:"register-selling-right min-w-[20.25rem] bg-white-400 backdrop-blur-[3.125rem] rounded-[0.25rem] flex flex-col gap-[1.25rem]",children:[(0,N.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem]",children:[(0,N.jsx)(d.A,{placeholder:e("kategoriyani qidirish..."),value:T,onChange:e=>{const t=e.target.value;J(t);const r=t.replace(/\s+/g," ").trim(),a=(0,s.filter)(P,(e=>e.name&&e.name.toLowerCase().includes(r)||e.code.includes(r)));B(""!==t?a:P)},onKeyUp:()=>{}}),(0,N.jsx)("div",{className:"grow relative overflow-auto",children:(0,N.jsx)("div",{className:"cards-container absolute left-0 right-[0.125rem] top-0 bottom-0",children:S?(0,N.jsx)("div",{className:"tableContainerPadding",children:(0,N.jsx)(c.A,{})}):Y.length>0?(0,s.map)(Y,(e=>(0,N.jsx)(n.A,{id:e._id,activeCategory:e._id===I,title:e.name,code:e.code,products:e.products.length,onClick:oe},e._id))):(0,N.jsx)(u.A,{text:e("Kategoriya mavjud emas")})})})]}),(0,N.jsxs)("div",{className:"flex gap-[0.625rem]",children:[(0,N.jsx)("button",{type:"button",className:"register-selling-right-accept-btn",onClick:()=>{F.length?(R(!0),X("complete")):w?(0,x.$5)():(0,x.QC)()},children:e("delivered"===te?"Qabul qilish":"Buyurtma berish")}),"delivered"!==te&&(0,N.jsx)("button",{type:"button",onClick:()=>{if(F.length>0){const e=F.reduce(((e,t)=>(0,b.tE)(e+t.totalprice)),0),r=F.reduce(((e,t)=>(0,b.Df)(e+t.totalpriceuzs)),0),a={temporary:{partner:D,tableProducts:F,totalPrice:e,totalPriceUzs:r}};t((0,j.K4)(a)).then((e=>{let{error:t}=e;t||(le(),_("/dukonlar/buyurtma_berish/saqlanganlar"))})),W&&(t((0,j.rG)({temporaryId:W._id})),Z(null))}else(0,x.lY)(e("Maxsulotlar ro'yxati bo'sh!"),"warning")},className:"register-selling-right-deny-btn",children:(0,N.jsx)(p.WiF,{size:"1.5rem"})})]})]})]})}}}]);
//# sourceMappingURL=156.a94bd755.chunk.js.map