"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2941],{3307:(e,t,l)=>{l.d(t,{A:()=>i});l(65043);var a=l(90221),n=l(70579);const i=e=>{let{text:t,onClick:l}=e;return(0,n.jsxs)("button",{onClick:l,className:"bg-blue-600 flex items-center gap-[0.3125rem] justify-center p-[10px] text-white-900 rounded-[0.5rem] shadow-[0_5px_15px_rgba(0,0,0,0.15)] transition-all ease-in-out duration-200 active:shadow-none hover:bg-blue-700",children:[(0,n.jsx)(a.zo4,{className:"text-white-900",size:"1.125rem"})," ",t&&(0,n.jsx)("span",{className:"text-sm leading-[1.125rem]",children:t})]})}},22662:(e,t,l)=>{l.d(t,{A:()=>i});const a=(0,l(55749).Ay)("http://185.250.207.95/"),n=JSON.parse(localStorage.getItem("userData"));a.auth={token:null===n||void 0===n?void 0:n.token,market:null===n||void 0===n?void 0:n.market};const i=a},12941:(e,t,l)=>{l.r(t),l.d(t,{default:()=>N});var a=l(65043),n=l(23237),i=l(54964),s=l(18446),o=l(37424),r=l(79456),d=l(4235),u=l(78054),c=l(71605),v=l(91154),m=l(43054),h=l(76694),p=l(12602),g=l(49092),f=l(53536),x=l(30200),y=l(73734),S=l(22662),b=l(97160),w=l(38069),D=l(85369),z=l(3297),j=l(66752),k=l(37919),P=l(3307),C=l(70579);const N=e=>{let{id:t}=e;const{t:l}=(0,g.B)(["common"]),N=[{title:"\u2116"},{title:l("Sana"),filter:"createdAt"},{title:l("ID"),filter:"id"},{title:l("Mijoz")},{title:l("Jami")},{title:l("Chegirma")},{title:l("Qarz")},{title:l("Izoh")},{title:"",styles:"w-[7rem]"}],I=(0,r.wA)(),{currencyType:A}=(0,r.d4)((e=>e.currency)),{user:B,market:O}=(0,r.d4)((e=>e.login)),{totalpayment:E}=(0,r.d4)((e=>e.reports)),[q,L]=(0,a.useState)(!1),{sellings:_,searchedSellings:W,getSellingsLoading:Y,total:M,totalSearched:U}=(0,r.d4)((e=>e.sellings)),{expenses:J}=(0,r.d4)((e=>e.expense)),[Q,T]=(0,a.useState)(""),[Z,F]=(0,a.useState)(_),[R,H]=(0,a.useState)(_),[X,$]=(0,a.useState)(M),[G,K]=(0,a.useState)(W),[V,ee]=(0,a.useState)(50),[te,le]=(0,a.useState)(0),[ae,ne]=(0,a.useState)(!1),[ie,se]=(0,a.useState)({id:"",client:"",product:"",phoneNumber:""}),[oe,re]=(0,a.useState)({filter:"",sort:"",count:0}),[de,ue]=(0,a.useState)(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),[ce,ve]=(0,a.useState)(new Date),[me,he]=(0,a.useState)(null),[pe,ge]=(0,a.useState)(!1),[fe,xe]=(0,a.useState)(!1),[ye,Se]=(0,a.useState)(null),[be,we]=(0,a.useState)([]),[De,ze]=(0,a.useState)(""),[je,ke]=(0,a.useState)(null),Pe=e=>{let{value:t}=e;ee(t),le(0)},Ce=(0,a.useMemo)((()=>({cash:{uzs:J.filter((e=>"cash"===e.type)).reduce(((e,t)=>{let{sumuzs:l}=t;return e+l}),0),usd:J.filter((e=>"cash"===e.type)).reduce(((e,t)=>{let{sum:l}=t;return e+l}),0)},card:{uzs:J.filter((e=>"card"===e.type)).reduce(((e,t)=>{let{sumuzs:l}=t;return e+l}),0),usd:J.filter((e=>"card"===e.type)).reduce(((e,t)=>{let{sum:l}=t;return e+l}),0)},transfer:{uzs:J.filter((e=>"transfer"===e.type)).reduce(((e,t)=>{let{sumuzs:l}=t;return e+l}),0),usd:J.filter((e=>"transfer"===e.type)).reduce(((e,t)=>{let{sum:l}=t;return e+l}),0)}})),[J]),Ne=e=>{const t=e.target.value,l=t.replace(/\s+/g," ").trim();if(h.C.test(t)&&se({...ie,id:t}),(G.length>0||U>0)&&I((0,m.ix)()),""===l)F(_),$(M);else{const e=(0,f.filter)(_,(e=>e.id.includes(l)));F(e),$(e.length)}},Ie=e=>{const t=e.target.value;ne(!0);const l=t.toLowerCase().replace(/\s+/g," ").trim();if(se({...ie,client:t}),(G.length>0||U>0)&&I((0,m.ix)()),""===l)F(_),K([]),ne(!1),$(M);else{const e=(0,f.filter)(_,(e=>{var t,a;return(null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.name.toLowerCase().includes(l))||(null===e||void 0===e||null===(a=e.packman)||void 0===a?void 0:a.name.toLowerCase().includes(l))}));K(e),$(e.length)}},Ae=e=>{const t=e.target.value;ne(!0);const l=t.toLowerCase().replace(/\s+/g," ").trim();if(se({...ie,phoneNumber:t}),(G.length>0||U>0)&&I((0,m.ix)()),""===l)F(_),K([]),ne(!1),$(M);else{const e=(0,f.filter)(_,(e=>{var t,a;return null===e||void 0===e||null===(t=e.client)||void 0===t||null===(a=t.phoneNumber)||void 0===a?void 0:a.toLowerCase().includes(l)}));K(e),$(e.length)}},Be=e=>{if("Enter"===e.key){le(0);const e={filialId:t,currentPage:te,countPage:V,startDate:de.toISOString(),endDate:ce.toISOString(),search:ie};I((0,m.d2)(e))}},Oe=()=>{xe(!fe)},Ee=()=>{ke(null),xe(!1)},qe=e=>{T("allChecksWithDetails"),he(e),ge(!0)},Le=e=>{T("addPlus"),ge(!0),Se(e)},[_e,We]=(0,a.useState)(""),[Ye,Me]=(0,a.useState)(null),Ue=(e,t)=>{We(t),Me(e._id),T("changeComment"),ge(!0)};(0,a.useEffect)((()=>{F(_),H(_)}),[_]),(0,a.useEffect)((()=>{$(M)}),[M]);const Je=async()=>{const e={filialId:t,currentPage:te,countPage:V,startDate:de.toISOString(),endDate:ce.toISOString(),search:{id:"",client:""}};I((0,m.WL)(e));const l={startDate:de,endDate:ce,search:ie};I((0,m.ah)(l))};(0,a.useEffect)((()=>{Je()}),[I,t,te,V,de,ce,ie]);const Qe=e=>{if(e===oe.filter)switch(oe.count){case 1:re({filter:e,sort:"1",count:2}),(0,x.Yc)(Z,F,e,1,R);break;case 2:re({filter:e,sort:"",count:0}),(0,x.Yc)(Z,F,e,"",R);break;default:re({filter:e,sort:"-1",count:1}),(0,x.Yc)(Z,F,e,-1,R)}else re({filter:e,sort:"-1",count:1}),(0,x.Yc)(Z,F,e,-1,R)},[Te,Ze]=(0,a.useState)(window.innerWidth<=768);(0,a.useEffect)((()=>{const e=()=>{Ze(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>{let e=[],t=[{label:"Xammasi",value:""}];O&&S.A.emit("getProductsOfCount",{market:O._id}),O&&S.A.on("getProductsOfCount",(l=>{let{id:a,products:n}=l;a===O._id&&(t=[...t,...(0,f.map)(n,(e=>({value:e._id,label:e.productdata.name})))],we(t),e.push(...n),I((0,b.UC)(e)))})),O&&S.A.on("error",(e=>{let{id:t,message:l}=e;t===O._id&&(0,y.lY)(l,"error")}))}),[O,I]);const Fe=e=>{ze(e);const l={filialId:t,currentPage:te,countPage:V,startDate:de.toISOString(),endDate:ce.toISOString(),search:{id:"",client:"",product:e.label}};I((0,m.d2)(l))},Re=[{value:50,label:50},{value:100,label:100},{value:150,label:150},{value:1e5,label:l("Barchasi")}];return(0,C.jsxs)(c.P.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.8,ease:[.04,.62,.23,.98]},children:[(0,C.jsx)(p.A,{printedSelling:me,currency:A,body:Q,isOpen:pe,toggleModal:()=>{ge(!pe),he(null);const e={filialId:t,currentPage:te,countPage:V,startDate:de.toISOString(),endDate:ce.toISOString(),search:{id:"",client:"",product:null===De||void 0===De?void 0:De.label}};I((0,m.WL)(e))},approveFunction:e=>{I((0,m.d5)({...e,saleconnectorid:ye})).then((()=>{const e={filialId:t,currentPage:te,countPage:V,startDate:de.toISOString(),endDate:ce.toISOString(),search:{id:"",client:""}};I((0,m.WL)(e))})),ge(!1)},commentText:_e,dailyid:Ye,isSalesList:!0}),(0,C.jsxs)("div",{className:"pagination lg:m-3 flex lg:justify-start items-center justify-evenly",children:[(0,C.jsx)("span",{className:"ms-[-10px] lg:ms-3"}),(0,C.jsx)(n.A,{onClick:()=>{let e="Sotuvlar"-(new Date).toLocaleDateString();const t=["\u2116",l("ID"),l("Mijoz"),l("Jami UZS"),l("Jami USD"),l("Chegirma UZS"),l("Chegirma USD"),l("Qarz UZS"),l("Qarz USD")];if((null===Z||void 0===Z?void 0:Z.length)>0){const l=(0,f.map)(Z,((e,t)=>{var l,a,n,i,s,o;return{nth:t+1,id:(null===e||void 0===e?void 0:e.id)||"",client:(null===e||void 0===e||null===(l=e.client)||void 0===l?void 0:l.name)||(null===e||void 0===e||null===(a=e.packman)||void 0===a?void 0:a.name),alluzs:(null===e||void 0===e||null===(n=e.products[0])||void 0===n?void 0:n.totalpriceuzs)||"",allusd:(null===e||void 0===e||null===(i=e.products[0])||void 0===i?void 0:i.totalprice)||"",discount:e.discounts.length>0?e.discounts.map((e=>e)):0,discountusd:e.discounts.length>0?e.discounts.map((e=>e)):0,debd:(null===e||void 0===e||null===(s=e.products[0])||void 0===s?void 0:s.totalpriceuzs)-(null===e||void 0===e||null===(o=e.payments[0])||void 0===o?void 0:o.paymentuzs)-(null===e||void 0===e?void 0:e.discounts.length)>0?e.discounts.map((e=>e.discount)):0,debdusd:e.products[0].totalprice-e.payments[0].payment-e.discounts.length>0?e.discounts.map((e=>e.discount)):0}}));(0,x.m1)(l,e,t)}else(0,y.lY)("Jadvalda ma'lumot mavjud emas !","warning")}}),Te&&(0,C.jsxs)("button",{onClick:()=>L(!0),className:"hover:bg-blue-200  bg-blue-400 focus-visible:outline-none w-[90px] h-[33px]  createElement",children:[(0,C.jsx)(D.YsJ,{})," ",l("izlash")]}),(0,C.jsx)("div",{className:"ml-3 px-4 py-2 flex justify-end",children:(0,C.jsx)(P.A,{text:"".concat(l("Savdo hisoboti")),onClick:async e=>{try{var t,l,a,n,i,s,o,r,d,u,c,v,h,p,g,f,x,y,S,b,w,D,z,P,C,N,A,B,O,q;let e={startDate:new Date(de),endDate:new Date(ce),search:{client:"",id:"",product:""}},L={startDate:new Date(de).toISOString(),endDate:new Date(ce)};const[{saleconnectors:_},{income:W,debts:Y,discounts:M},{totalpieces:U},{totalpieces:J,totalprice:Q,totalpriceuzs:Z,producttypes:F}]=await Promise.all([await I((0,m.ah)(e)).unwrap(),await I((0,j.RI)(L)).unwrap(),await I((0,j.U7)(L)).unwrap(),await I((0,k.d$)()).unwrap(),await I((0,j.Hj)(e)).unwrap(),await I((0,j.Qj)(e)).unwrap()]);he({boshsana:de,tugashsana:ce,sotuvlarsoni:_.length,tushumlar:{naqt:{sum:null===E||void 0===E||null===(t=E.payment)||void 0===t?void 0:t.cashuzs,dollar:null===E||void 0===E||null===(l=E.payment)||void 0===l?void 0:l.cash},plastik:{sum:null===E||void 0===E||null===(a=E.payment)||void 0===a?void 0:a.carduzs,dollar:null===E||void 0===E||null===(n=E.payment)||void 0===n?void 0:n.card},utkazma:{sum:null===E||void 0===E||null===(i=E.payment)||void 0===i?void 0:i.transferuzs,dollar:null===E||void 0===E||null===(s=E.payment)||void 0===s?void 0:s.transfer}},qaytarilganlar:{naqt:{sum:null===E||void 0===E||null===(o=E.back)||void 0===o?void 0:o.cashuzs,dollar:null===E||void 0===E||null===(r=E.back)||void 0===r?void 0:r.cash},plastik:{sum:null===E||void 0===E||null===(d=E.back)||void 0===d?void 0:d.carduzs,dollar:null===E||void 0===E||null===(u=E.back)||void 0===u?void 0:u.card},utkazma:{sum:null===E||void 0===E||null===(c=E.back)||void 0===c?void 0:c.transferuzs,dollar:null===E||void 0===E||null===(v=E.back)||void 0===v?void 0:v.transfer}},xarajatlar:{naqt:{sum:null===Ce||void 0===Ce||null===(h=Ce.cash)||void 0===h?void 0:h.uzs,dollar:null===Ce||void 0===Ce||null===(p=Ce.cash)||void 0===p?void 0:p.usd},plastik:{sum:null===Ce||void 0===Ce||null===(g=Ce.card)||void 0===g?void 0:g.uzs,dollar:null===Ce||void 0===Ce||null===(f=Ce.card)||void 0===f?void 0:f.usd},utkazma:{sum:null===Ce||void 0===Ce||null===(x=Ce.transfer)||void 0===x?void 0:x.uzs,dollar:null===Ce||void 0===Ce||null===(y=Ce.transfer)||void 0===y?void 0:y.usd}},foyda:{sum:null===W||void 0===W?void 0:W.incomeuzs,dollar:null===W||void 0===W?void 0:W.income},qarzlar:{sum:null===Y||void 0===Y?void 0:Y.debtsuzs,dollar:null===Y||void 0===Y?void 0:Y.debts},chegirmalar:{sum:null===M||void 0===M?void 0:M.discountsuzs,dollar:null===M||void 0===M?void 0:M.discounts},kassaqoldiq:{naqt:{sum:(null===E||void 0===E||null===(S=E.result)||void 0===S?void 0:S.cashuzs)-(null===Ce||void 0===Ce||null===(b=Ce.cash)||void 0===b?void 0:b.uzs),dollar:(null===E||void 0===E||null===(w=E.result)||void 0===w?void 0:w.cash)-(null===Ce||void 0===Ce||null===(D=Ce.cash)||void 0===D?void 0:D.usd)},plastik:{sum:(null===E||void 0===E||null===(z=E.result)||void 0===z?void 0:z.carduzs)-(null===Ce||void 0===Ce||null===(P=Ce.card)||void 0===P?void 0:P.uzs),dollar:(null===E||void 0===E||null===(C=E.result)||void 0===C?void 0:C.card)-(null===Ce||void 0===Ce||null===(N=Ce.card)||void 0===N?void 0:N.usd)},utkazma:{sum:(null===E||void 0===E||null===(A=E.result)||void 0===A?void 0:A.transferuzs)-(null===Ce||void 0===Ce||null===(B=Ce.transfer)||void 0===B?void 0:B.uzs),dollar:(null===E||void 0===E||null===(O=E.result)||void 0===O?void 0:O.transfer)-(null===Ce||void 0===Ce||null===(q=Ce.transfer)||void 0===q?void 0:q.usd)}},sotilganmaxsulotlarsoni:U,qolganmaxsulotlarsoni:F,qolganmaxsulotlarumumiysoni:J,qolganmaxsulotlarqiymati:{sum:Z,dollar:Q}}),T("dailySaleCheck"),ge(!0)}catch(L){return console.error(L)}}})})]}),Te?q&&(0,C.jsxs)("div",{className:"absolute lg:p-[50px] w-[100vw]  h-[100vh]  flex justify-evenly flex-wrap   top-0\tleft-0 z-50 bg-[white]\t",children:[(0,C.jsx)(v.hvQ,{onClick:()=>L(!1),className:" absolute right-[20px]  top-[20px]  text-4xl cursor-pointer"}),(0,C.jsxs)("div",{className:"mt-[100px]",children:[(0,C.jsx)(o.A,{filterBy:["total","startDate","endDate","id","clientName","product_name"],filterByTotal:Pe,startDate:de,setStartDate:ue,endDate:ce,filterByClientPhoneNumber:Ae,setEndDate:ve,searchById:ie.id,searchByClientName:ie.client,phoneNumber:ie.phoneNumber,filterByClientName:Ie,filterById:Ne,filterByClientNameWhenPressEnter:Be,filterByIdWhenPressEnter:Be,filteredProducts:be,handleChangeSelectedProduct:Fe,selectedProduct:De}),(0,C.jsx)("div",{className:"flex justify-center",children:(0,C.jsxs)("button",{onClick:()=>L(!1),className:"hover:bg-blue-200  bg-blue-400 focus-visible:outline-none w-[150px] h-[40px]  createElement",children:[(0,C.jsx)(D.YsJ,{})," ",l("izlash")]})})]})]}):(0,C.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,C.jsx)("div",{className:"mt-6",children:(0,C.jsx)(w.A,{otherOptions:Re,onSelect:Pe},"total_1")}),(0,C.jsx)(o.A,{filterBy:["page_changer","total","startDate","endDate","id","clientName","clientPhoneNumber","product_name"],filterByTotal:Pe,filterByClientPhoneNumber:Ae,startDate:de,setStartDate:ue,phoneNumber:ie.phoneNumber,endDate:ce,setEndDate:ve,searchById:ie.id,searchByClientName:ie.client,filterByClientName:Ie,filterById:Ne,filterByClientNameWhenPressEnter:Be,filterByIdWhenPressEnter:Be,filteredProducts:be,handleChangeSelectedProduct:Fe,selectedProduct:De})]}),(0,C.jsxs)("div",{className:"lg:tableContainerPadding",children:[Y?(0,C.jsx)(d.A,{}):0===Z.length&&0===G.length?(0,C.jsx)(u.A,{text:"".concat(l("Ro'yxat mavjud emas"))}):Te?(0,C.jsx)(z.A,{data:G.length>0?G:Z,currentPage:te,currency:A,countPage:V,page:"saleslist",headers:N,Print:qe,addPlus:Le,Sort:Qe,sortItem:oe,sellers:"Seller"===(null===B||void 0===B?void 0:B.type),editComment:Ue}):(0,C.jsx)(s.A,{data:ae?G:Z,currentPage:te,currency:A,countPage:V,page:"saleslist",headers:N,Print:qe,addPlus:Le,Sort:Qe,sortItem:oe,sellers:"Seller"===(null===B||void 0===B?void 0:B.type),editComment:Ue,handleDelete:e=>{ke(e),Oe()}}),(0,C.jsx)("div",{className:"m-4 flex justify-center",children:(0!==X||0!==U)&&(0,C.jsx)(i.A,{countPage:Number(V),totalDatas:U||X,currentPage:te,setCurrentPage:le})}),(0,C.jsx)(p.A,{body:"approve",toggleModal:Oe,headerText:"".concat(l("Maxsulotni o`chirishni tasdiqlaysizmi?")),title:l("O`chirilgan maxsulotlarni tiklashning imkoni mavjud emas!"),approveFunction:async()=>{try{await I((0,m.cZ)({saleconnectorId:je._id})),await Je(),Ee()}catch(e){console.error("Error deleting sale connector:",e)}},closeModal:Ee,isOpen:fe})]})]},"content")}}}]);
//# sourceMappingURL=2941.fe896196.chunk.js.map